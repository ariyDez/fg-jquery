"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(e){return document.createRange().createContextualFragment(e)}var n="http://127.0.0.1:8000/api",o="ru",r=[],i=[],a={init:function(t){n="http://"+t.host+"/api",o=t.language,console.log("init",this),e.get("http://"+t.host+"/api/service/"+t.service).done(function(e){console.log(e),a.renderForm(e)})},destroy:function(){console.log("destroy")},send:function(t){console.log("click",t);e('input[name="step"]').val();console.log(e("#formData").serialize());var o=e("#formData").serialize();e.post(n+"/changeStep",o).done(function(e){console.log(e),"string"!=typeof e?a.renderForm(e):alert(e)}).fail(function(e){console.log(e)}),t.preventDefault()},renderForm:function(t){var n=e("#askartec-form"),r="",l=t.step;r+="<h2>"+l.name+" step</h2>",r+='<input type="hidden" name="service" value="'+t._id+'">',r+='<input type="hidden" name="step" value="'+l._id+'">',t.user&&(r+='<input type="hidden" name="user" value="'+t.user._id+'">');var c=l.sections,u=!0,s=!1,d=void 0;try{for(var p,f=c[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var v=p.value;r+=v.name?"<h2>"+v.name+"</h2>":"";var h=v.inputs;i=i.concat(h);var m=!0,y=!1,g=void 0;try{for(var b,_=h[Symbol.iterator]();!(m=(b=_.next()).done);m=!0){var S=b.value;this.inputElement=S,r+='<div class="askartec-form-group">\n                    <label for="'+S._id+'">'+this.getLabel(S._id,o)+(S.required?"*":"")+":</label>\n                    "+this.generateInputElement(S)+"\n                    </div>"}}catch(e){y=!0,g=e}finally{try{!m&&_.return&&_.return()}finally{if(y)throw g}}}}catch(e){s=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw d}}var $='<form id="formData">\n                    '+r+'\n                    <button class="next-send">Send</button>\n                </form>';n.html($),e(".next-send").bind("click.formGenerator",a.send),e(".linked-select").bind("change.formGenerator",a.fillChildSelect)},generateInputElement:function(e){function t(e){return"<input type='"+e.type+"' name='"+e._id+"' "+(e.required?"required":"")+" id='"+e._id+"'>"}return{text:t,checkbox:t,radio:t,select:function(e){return"<select name='"+e._id+"_select' "+(e.required?"required":"")+" id='"+e.name+"' "+(e.child?'class="linked-select"':"")+'" child="'+e.child+'">\n                    '+e.label+"\n                    "+function(){var t=e.options,n="<option>--Choose--</option>",o=!0,i=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;n+="<option value='"+u._id+"' data-option='"+u.data_option+"'>"+u.value+"</option>",r.push(u)}}catch(e){i=!0,a=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}return n}()+"\n                </select>"}}[e.type](e)},giveSelection:function(n){console.log("give selection",this),$current=e(this);var o=$current.attr("id").replace(/^\D+/g,""),i=++o,a=e("#select-name"+i);console.log(i),console.log($current.val()),options2=r,a.html("");for(var l=0;l<options2.length;l++){var c=t("<option value='"+options2[l].value+"' data-option='"+options2[l].data_option+"'>"+options2[l].name+"</option>");options2[l].data_option===$current.val()&&a.append(c)}},fillChildSelect:function(o){$current=e(this);var r=$current.attr("child"),a=$current.val(),l=i.find(function(e){return r===e._id});$child=e("#"+l.name),e.get(n+"/option/"+a+"/options",function(e){$child.html(""),$child.append("<option>--Choose--</option>");for(var n=0;n<e.length;n++){var o=t("<option value='"+e[n]._id+"'>"+e[n].value+"</option>");$child.append(o)}})},getLabel:function(e,t){var n=i.find(function(t){return t._id===e}).languages.find(function(e){return e.alias===t});return n?n.text:"no label"}};e.fn.formGenerator=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==(void 0===t?"undefined":_typeof(t))&&t?void e.error("Method with name "+t+" doesn't exist for jQuery formGenerator"):a.init.apply(this,arguments)}}(jQuery);